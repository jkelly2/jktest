This is the super main function.  There may be a slight mistaik contained within it.
Other than that, it's brilliant.